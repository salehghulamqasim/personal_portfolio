<!DOCTYPE html>
<html lang="en">
<head>
  <base href="/">

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta name="description" content="Saleh Ghulam – Full-Stack Developer Portfolio">
  <meta name="theme-color" content="#ffffff">

  <!-- iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="web/icons/saleh.svg">

  <!-- icon -->
  <link rel="icon" href="web/icons/cat.webp">

  <!-- critical preload – Safari-safe (no spaces!) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="splash.json" as="fetch" crossorigin>

  <title>Saleh Ghulam – Portfolio</title>
  <link rel="manifest" href="manifest.json">

  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{display:flex;align-items:center;justify-content:center;background:#fff;font-family:system-ui,-apple-system,sans-serif}
    #s{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:#fff;z-index:99999;transition:opacity .6s}
    #s.out{opacity:0;pointer-events:none}
    #l{width:80vmin;height:80vmin;max-width:400px;max-height:400px}
    #f{display:none;width:60px;height:60px;border:6px solid #f3f3f3;border-top-color:#3498db;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <div id="s">
    <div id="l"></div>
    <div id="f"></div>
  </div>

  <!-- Lottie loaded AFTER first paint -->
  <script defer src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>

  <script>
    (function(){
      const splash = document.getElementById('s');
      const lottieContainer = document.getElementById('l');
      const spinner = document.getElementById('f');
      const min = 1800;                 // minimum show time
      const hard = 10000;               // absolute max
      const start = performance.now();
      let ok = 0;

      /* Lottie or fallback */
      function init(){
        if(!window.lottie){spinner.style.display='block';lottieContainer.style.display='none';return;}
        try{
          lottie.loadAnimation({
            container:lottieContainer,
            renderer:'svg',
            loop:true,
            autoplay:true,
            path:'splash.json'
          }).setSpeed(.8);
        }catch(e){
          spinner.style.display='block';
          lottieContainer.style.display='none';
        }
      }
      /* tear down */
      function hide(){
        ok=1;
        const left = Math.max(0,min-(performance.now()-start));
        setTimeout(()=>{
          splash.classList.add('out');
          requestAnimationFrame(()=>setTimeout(()=>splash.remove(),700));
        },left);
      }
      /* triggers */
      window.addEventListener('flutter-first-frame',hide,{once:true});
      setTimeout(hide,hard);

      /* start Lottie when script arrives */
      if(window.lottie)init();
      else document.currentScript.onload=init;
    })();
  </script>

  <!-- Flutter -->
  <script src="flutter_bootstrap.js" async></script>
</body>
</html>